"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[729],{63560:(e,t,a)=>{a.d(t,{A:()=>b});var r=a(35906),o=a(98778),l=a(12250),s=a.n(l),n=a(49785),i=a(64732),c=a(29241),u=a(51803),d=a(48070),m=a(4829),p=a(66170),g=a(66092),f=a(35218),h=a(67370),E=a(25635),y=a(70252);const v=({name:e,label:t,formLabel:a,type:l="text",options:s=[],rules:v={},error:b,placeholder:_,inputProps:w,control:A,autoComplete:k,defaultValue:C,helpText:S,children:x,inputRef:M})=>{const B=(0,y.A)(),[T,z]=(0,o.useState)(!0),F=T?E.IT:E.$G,L=T?B.formatMessage({id:"field.password.assistive_msg.show_password",defaultMessage:[{type:0,value:"Show password"}]}):B.formatMessage({id:"field.password.assistive_msg.hide_password",defaultMessage:[{type:0,value:"Hide password"}]}),$="password"===l&&T?"password":"password"===l?"text":l;return o.createElement(n.xI,{name:e,control:A,rules:v,defaultValue:C,render:({field:{onChange:n,value:y,ref:v}})=>{const A="function"==typeof w?w({value:y,onChange:n}):w;return o.createElement(i.MJ,{id:e,isInvalid:b},!["checkbox","radio","hidden"].includes(l)&&(a||o.createElement(c.l,null,t)),o.createElement(u.M,null,["text","password","email","phone","tel","number"].includes(l)&&o.createElement(d.p,(0,r.A)({ref:e=>{v(e),M&&(M.current=e)},onChange:n,value:y,type:$,placeholder:_,autoComplete:k},A)),"hidden"===l&&o.createElement("input",(0,r.A)({ref:v,onChange:n,value:y,type:"hidden"},A)),"password"===l&&o.createElement(m.t,null,o.createElement(p.K,{variant:"ghosted","aria-label":L,icon:o.createElement(F,{color:"gray.500",boxSize:6}),onClick:()=>z(!T)})),"select"===l&&o.createElement(g.l,(0,r.A)({ref:v,onChange:n,value:y,placeholder:_},A),s.map((e=>o.createElement("option",{key:`${e.label}-${e.value}`,value:e.value},e.label)))),"checkbox"===l&&o.createElement(f.S,(0,r.A)({ref:v,onChange:e=>n(e.target.checked),isChecked:y},A),a||t),x),b&&"hidden"!==l&&o.createElement(h.Wt,{color:"red.600"},o.createElement(E._0,{"aria-hidden":"true",mr:2}),b.message),S)}})};v.propTypes={name:s().string,label:s().string,autoComplete:s().string,formLabel:s().any,type:s().oneOf(["text","number","password","email","phone","tel","select","checkbox","hidden"]),options:s().arrayOf(s().shape({label:s().string,value:s().any})),rules:s().object,error:s().shape({message:s().string}),placeholder:s().string,inputProps:s().oneOfType([s().object,s().func]),control:s().object,defaultValue:s().any,helpText:s().any,children:s().any,inputRef:s().object};const b=v},24001:(e,t,a)=>{a.r(t),a.d(t,{default:()=>L});var r=a(8805),o=a(98778),l=a(12250),s=a.n(l),n=a(57131),i=a(70252),c=a(36287),u=a(66272),d=a(54007),m=a(7711),p=a(41375),g=a(49785),f=a(25149),h=a(65376),E=a(20751),y=a(86400),v=a(40133),b=a(76315),_=a(14893),w=a(25635),A=a(63560);const k=({form:e,prefix:t=""})=>{const a=function({form:{control:e,formState:{errors:t}},prefix:a=""}){const{formatMessage:r}=(0,i.A)();return{email:{name:`${a}email`,label:r({defaultMessage:[{type:0,value:"Email"}],id:"use_login_fields.label.email"}),placeholder:"you@email.com",defaultValue:"",type:"email",autoComplete:"email",rules:{required:r({defaultMessage:[{type:0,value:"Please enter your email address."}],id:"use_login_fields.error.required_email"})},error:null==t?void 0:t[`${a}email`],control:e},password:{name:`${a}password`,label:r({defaultMessage:[{type:0,value:"Password"}],id:"use_login_fields.label.password"}),defaultValue:"",type:"password",rules:{required:r({defaultMessage:[{type:0,value:"Please enter your password."}],id:"use_login_fields.error.required_password"})},error:null==t?void 0:t[`${a}password`],control:e}}}({form:e,prefix:t});return o.createElement(y.B,{spacing:5},o.createElement(A.A,a.email),o.createElement(A.A,a.password))};k.propTypes={form:s().object.isRequired,prefix:s().string};const C=k;var S=a(17015);const x=({submitForm:e,clickForgotPassword:t=S.lQ,clickCreateAccount:a=S.lQ,form:r})=>{var l;return o.createElement(o.Fragment,null,o.createElement(y.B,{justify:"center",align:"center",spacing:8,marginBottom:8},o.createElement(w.FQ,{width:"60px",height:"auto"}),o.createElement(v.E,{align:"center",fontSize:"xl",fontWeight:"semibold"},o.createElement(E.A,{defaultMessage:[{type:0,value:"Welcome Back"}],id:"login_form.message.welcome_back"}))),o.createElement("form",{id:"login-form",onSubmit:r.handleSubmit(e),"data-testid":"sf-auth-modal-form"},o.createElement(y.B,{spacing:8,paddingLeft:4,paddingRight:4},(null===(l=r.formState.errors)||void 0===l?void 0:l.global)&&o.createElement(b.F,{status:"error"},o.createElement(w._0,{color:"red.500",boxSize:4}),o.createElement(v.E,{fontSize:"sm",ml:3},r.formState.errors.global.message)),o.createElement(y.B,null,o.createElement(C,{form:r}),o.createElement(c.az,null,o.createElement(_.$,{variant:"link",size:"sm",onClick:t},o.createElement(E.A,{defaultMessage:[{type:0,value:"Forgot password?"}],id:"login_form.link.forgot_password"})))),o.createElement(y.B,{spacing:6},o.createElement(_.$,{type:"submit",onClick:()=>{r.clearErrors("global")},isLoading:r.formState.isSubmitting},o.createElement(E.A,{defaultMessage:[{type:0,value:"Sign In"}],id:"login_form.button.sign_in"})),o.createElement(y.B,{direction:"row",spacing:1,justify:"center"},o.createElement(v.E,{fontSize:"sm"},o.createElement(E.A,{defaultMessage:[{type:0,value:"Don't have an account?"}],id:"login_form.message.dont_have_account"})),o.createElement(_.$,{variant:"link",size:"sm",onClick:a},o.createElement(E.A,{defaultMessage:[{type:0,value:"Create account"}],id:"login_form.action.create_account"})))))))};x.propTypes={submitForm:s().func,clickForgotPassword:s().func,clickCreateAccount:s().func,form:s().object};const M=x;var B=a(32105),T=a(94012);const z=(0,n.zR)({defaultMessage:[{type:0,value:"Incorrect username or password, please try again."}],id:"login_page.error.incorrect_username_or_password"}),F=()=>{const{formatMessage:e}=(0,i.A)(),t=(0,m.A)(),a=(0,g.mN)(),l=(0,f.zy)(),s=(0,h.A)(),{isRegistered:n,customerType:E}=(0,d.useCustomerType)(),y=(0,d.useAuthHelper)(d.AuthHelpers.LoginRegisteredUserB2C),v=(0,d.useCustomerId)(),b=(0,T.Z)(E),{data:_}=(0,d.useCustomerBaskets)({parameters:{customerId:v}},{enabled:!!v&&!S.S$,keepPreviousData:!0}),w=(0,d.useShopperBasketsMutation)("mergeBasket"),A=function(){var t=(0,r.A)((function*(t){try{var r,o,l;yield y.mutateAsync({username:t.email,password:t.password});(null==_||null===(r=_.baskets)||void 0===r||null===(o=r[0])||void 0===o||null===(l=o.productItems)||void 0===l?void 0:l.length)>0&&"guest"===b&&w.mutate({headers:{"Content-Type":"application/json"},parameters:{createDestinationBasket:!0}})}catch(t){const r=/Unauthorized/i.test(t.message)?e(z):e(B.gS);a.setError("global",{type:"manual",message:r})}}));return function(e){return t.apply(this,arguments)}}();return(0,o.useEffect)((()=>{var e;n&&(null!=l&&null!==(e=l.state)&&void 0!==e&&e.directedFrom?t(l.state.directedFrom):t("/account"))}),[n]),(0,o.useEffect)((()=>{s.sendViewPage(l.pathname)}),[]),o.createElement(c.az,{"data-testid":"login-page",bg:"gray.50",py:[8,16]},o.createElement(p.A,{title:"Sign in",description:"Customer sign in"}),o.createElement(u.m,{paddingTop:16,width:["100%","407px"],bg:"white",paddingBottom:14,marginTop:8,marginBottom:8,borderRadius:"base"},o.createElement(M,{form:a,submitForm:A,clickCreateAccount:()=>t("/registration"),clickForgotPassword:()=>t("/reset-password")})))};F.getTemplateName=()=>"login",F.propTypes={match:s().object};const L=F}}]);